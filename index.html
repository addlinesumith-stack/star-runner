<!DOCTYPE html>
<html>
<head>
<title>Star Runner RPG â€“ The Golden Star Saga</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#87CEEB;font-family:Arial;overflow:hidden}
#ui{position:absolute;top:10px;left:10px;color:white;font-size:18px;text-shadow:2px 2px 4px #000}
#overlay,#story,#gameOver{
position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
background:rgba(0,0,0,.9);color:white;padding:30px;border-radius:10px;
display:none;text-align:center;z-index:100
}
button{padding:10px 25px;font-size:18px;cursor:pointer}
canvas{display:block;margin:auto;background:#87CEEB}
</style>
</head>

<body>

<div id="overlay">
<h2>Enter Hero Name</h2>
<input id="nameInput" maxlength="15" style="padding:10px;font-size:18px">
<br><br>
<button onclick="start()">Start Adventure</button>
</div>

<div id="ui">
<div>Level: <span id="lvl">1</span></div>
<div>Lives: <span id="life">3</span></div>
<div>Score: <span id="scr">0</span></div>
</div>

<div id="story">
<h2 id="storyTitle"></h2>
<p id="storyText"></p>
<br>
<button onclick="resume()">Continue</button>
</div>

<div id="gameOver">
<h2 id="endTitle"></h2>
<p id="endText"></p>
<br>
<button onclick="location.reload()">Restart</button>
</div>

<canvas id="game" width="800" height="600"></canvas>

<script>
/* ================= CORE ================= */
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

let level=1,lives=3,score=0,gameRunning=false;
let gravity=0.6,jumpPower=13,damageCooldown=0;
let playerName="Hero";

/* ================= LEVEL DATA ================= */
const levelText=[
"Your journey begins.",
"The forest grows darker.",
"Enemies multiply.",
"The ground betrays you.",
"Heat rises.",
"Precision required.",
"The sky fights back.",
"Almost there.",
"The castle gates.",
"Final Battle!"
];

/* ================= PLAYER ================= */
const player={
x:50,y:400,w:30,h:40,dx:0,dy:0,grounded:false
};

/* ================= ENEMY ================= */
class Enemy{
constructor(x,y,speed){
this.x=x;this.y=y;this.w=30;this.h=30;
this.dx=speed;this.dead=false;
}
update(){
this.x+=this.dx;
if(this.x<50||this.x>750)this.dx*=-1;
}
draw(){
ctx.fillStyle='red';
ctx.fillRect(this.x,this.y,this.w,this.h);
}
}

/* ================= BOSS ================= */
const boss={
active:false,
x:300,y:150,w:120,h:80,
dx:2,health:10,
projectiles:[]
};

function updateBoss(){
boss.x+=boss.dx;
if(boss.x<100||boss.x>580)boss.dx*=-1;

if(Math.random()<0.02){
boss.projectiles.push({x:boss.x+60,y:boss.y+80,dy:4});
}

boss.projectiles.forEach(p=>p.y+=p.dy);
boss.projectiles=boss.projectiles.filter(p=>p.y<600);
}

function drawBoss(){
ctx.fillStyle='purple';
ctx.fillRect(boss.x,boss.y,boss.w,boss.h);

ctx.fillStyle='white';
ctx.fillRect(250,20,300,10);
ctx.fillStyle='red';
ctx.fillRect(250,20,300*(boss.health/10),10);

boss.projectiles.forEach(p=>{
ctx.fillStyle='orange';
ctx.fillRect(p.x,p.y,10,10);
});
}

/* ================= PLATFORMS ================= */
function generatePlatforms(lvl){
let arr=[];
for(let i=0;i<5;i++){
arr.push({x:100+i*120,y:450-(lvl*10)%200,w:100,h:20});
}
return arr;
}

/* ================= GAME STATE ================= */
let platforms=[],enemies=[];

function initLevel(){
platforms=generatePlatforms(level);
enemies=[];
boss.active=(level===10);

if(!boss.active){
for(let i=0;i<level;i++){
enemies.push(new Enemy(200+i*80,400,1+level*0.1));
}
}else{
boss.health=10;
boss.projectiles=[];
}

player.x=50;player.y=400;player.dx=0;player.dy=0;
showStory();
}

/* ================= STORY ================= */
function showStory(){
document.getElementById('storyTitle').textContent=`Stage ${level}`;
document.getElementById('storyText').textContent=levelText[level-1];
document.getElementById('story').style.display='block';
}

function resume(){
document.getElementById('story').style.display='none';
gameRunning=true;
requestAnimationFrame(loop);
}

/* ================= GAME LOOP ================= */
function loop(){
if(!gameRunning)return;
ctx.clearRect(0,0,800,600);

player.dy+=gravity;
player.x+=player.dx;
player.y+=player.dy;
player.grounded=false;

platforms.forEach(p=>{
ctx.fillStyle='#8B4513';
ctx.fillRect(p.x,p.y,p.w,p.h);
if(player.dy>=0 &&
player.y+player.h<=p.y+10 &&
player.y+player.h+player.dy>=p.y &&
player.x+player.w>p.x &&
player.x<p.x+p.w){
player.y=p.y-player.h;
player.dy=0;
player.grounded=true;
}
});

if(player.y+player.h>580){
player.y=580-player.h;
player.dy=0;
player.grounded=true;
}

enemies.forEach(e=>{
e.update();e.draw();
if(damageCooldown===0 &&
player.x<e.x+e.w&&player.x+player.w>e.x&&
player.y<e.y+e.h&&player.y+player.h>e.y){
lives--;damageCooldown=60;
if(lives<=0)return end(false);
}
});

if(boss.active){
updateBoss();
drawBoss();

boss.projectiles.forEach(p=>{
if(player.x<p.x+10&&player.x+player.w>p.x&&
player.y<p.y+10&&player.y+player.h>p.y){
lives--;damageCooldown=60;
if(lives<=0)return end(false);
}
});

if(player.dy>0 &&
player.y+player.h<boss.y+20 &&
player.y+player.h+player.dy>boss.y &&
player.x+player.w>boss.x &&
player.x<boss.x+boss.w){
boss.health--;
player.dy=-10;
if(boss.health<=0)return end(true);
}
}

ctx.fillStyle='gold';
ctx.fillRect(player.x,player.y,player.w,player.h);

if(!boss.active && player.x>760){
score+=level*100;
level++;
gameRunning=false;
if(level>10)return end(true);
initLevel();
}

if(damageCooldown>0)damageCooldown--;

document.getElementById('lvl').textContent=level;
document.getElementById('life').textContent=lives;
document.getElementById('scr').textContent=score;

requestAnimationFrame(loop);
}

/* ================= INPUT ================= */
window.addEventListener('keydown',e=>{
if(e.key==='ArrowLeft')player.dx=-4;
if(e.key==='ArrowRight')player.dx=4;
if(e.key==='ArrowUp'&&player.grounded){
player.dy=-jumpPower;
player.grounded=false;
}
});

/* ================= END ================= */
function end(win){
gameRunning=false;
document.getElementById('gameOver').style.display='block';
document.getElementById('endTitle').textContent=win?'Victory!':'Game Over';
document.getElementById('endText').textContent=`Final Score: ${score}`;
}

/* ================= START ================= */
function start(){
playerName=document.getElementById('nameInput').value||'Hero';
document.getElementById('overlay').style.display='none';
initLevel();
}
document.getElementById('overlay').style.display='block';
</script>

</body>
</html>
